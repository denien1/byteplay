<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>BytePlay — Instant classics, in your browser</title>
  <meta name="description" content="Play SNES, GBA, Atari 2600 and more in your browser.">
  <link rel="manifest" href="site.webmanifest">
  <meta name="theme-color" content="#0b0f15">
  <link rel="icon" href="assets/favicon.svg">
  <link rel="icon" type="image/png" sizes="512x512" href="assets/favicon-512.png">
  <link rel="apple-touch-icon" href="assets/maskable-192.png">

  <!-- Nintendo font (preload if present) -->
  <link rel="preload" href="assets/fonts/nintendo/Nintendo.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <!-- particles background -->
  <div id="particles-js"></div>

  <div class="container">
    <!-- Header -->
    <header class="header">
      <a class="brand" href="./" title="Return Home">
        <img src="assets/logo.svg" alt="BytePlay" />
        <div class="brand-text">
          <b class="brand-title">BytePlay</b>
          <small>Instant classics, in your browser.</small>
        </div>
      </a>
      <nav class="nav">
        <a class="btn ghost" href="#grid">Browse all Games</a>
        <div class="dropdown">
          <button id="sysBtn" class="btn ghost">Systems ▾</button>
          <div class="menu" id="sysMenu">
            <a href="#" data-sys="">All Systems</a>
            <a href="#" data-sys="gba">GBA</a>
            <a href="#" data-sys="snes">SNES</a>
            <a href="#" data-sys="atari2600">Atari 2600</a>
          </div>
        </div>
        <a class="btn ghost" href="play.html?id=byor">Upload ROM</a>
        <a class="btn ghost" href="about.html">About</a>
        <a class="btn ghost" href="contact.html">Contact</a>
      </nav>
    </header>

    <!-- HERO (centered) -->
    <section class="hero hero--center">
      <h1 class="hero-title">BytePlay</h1>
      <h2 class="hero-subtitle">Pick a classic. Press start.</h2>
      <p class="hero-tagline">Click a cover to start playing immediately. Save states and settings live in your browser.</p>
      <div class="hero-actions">
        <a href="#grid" class="btn primary">Browse all Games</a>
      </div>
    </section>

    <!-- Optional search / filters (keep or remove) -->
    <div class="search">
      <input id="q" placeholder="Search title or genre…">
      <select id="year">
        <option value="">All years</option>
        <option>1982</option><option>1990</option><option>1998</option>
        <option>2014</option><option>2018</option><option>2020</option>
      </select>
      <button id="reset">Reset</button>
    </div>

    <!-- Grid + pager -->
    <div id="count" class="meta"></div>
    <div id="grid" class="grid"></div>
    <div class="pager">
      <button class="btn" id="prev">Prev</button>
      <span id="pageLabel" class="meta"></span>
      <button class="btn" id="next">Next</button>
    </div>

    <footer>© <a class="link" href="./">BytePlay</a></footer>
  </div>

  <!-- App logic -->
  <script>
  const PAGE=12;let all=[],filtered=[],page=1,sysFilter="";
  const sysBtn=document.getElementById('sysBtn');const sysMenu=document.getElementById('sysMenu');
  sysBtn.onclick=()=>{sysMenu.style.display=sysMenu.style.display==='block'?'none':'block';};
  document.addEventListener('click',(e)=>{if(!sysMenu.contains(e.target)&&e.target!==sysBtn)sysMenu.style.display='none';});

  async function load(){
    try{
      const r=await fetch('games.json',{cache:'no-store'});
      const data=await r.json();
      // no Neo Geo in site
      all=(data.games||[]).filter(g=>['gba','snes','atari2600'].includes(g.system));
      filtered=[...all];render();wire();
    }catch(e){console.error(e);}
  }
  function apply(){
    const q=document.getElementById('q').value.toLowerCase().trim();
    const yr=document.getElementById('year').value;
    filtered=all.filter(g=>{
      const t=(g.title+' '+(g.genre||'')+' '+(g.system||'')).toLowerCase();
      if(q&&!t.includes(q))return false;
      if(sysFilter&&g.system!==sysFilter)return false;
      if(yr&&String(g.year)!==yr)return false;
      return true;
    });
    page=1;render();
  }
  function render(){
    const grid=document.getElementById('grid');
    const count=document.getElementById('count');
    const total=filtered.length;const start=(page-1)*PAGE;const slice=filtered.slice(start,start+PAGE);
    count.textContent=`${total} game${total!==1?'s':''} found`;
    grid.innerHTML=slice.map(g=>`
      <a class='card' href='play.html?id=${g.id}' title='Play ${g.title}'>
        <img class='cover' src='${g.cover}' alt='${g.title}'>
        <div class='content'>
          <div class='title'>${g.title}</div>
          <div class='meta'>${(g.system||'').toUpperCase()} • ${g.year||''} ${g.genre?('• '+g.genre):''}</div>
        </div>
      </a>`).join('');
    document.getElementById('pageLabel').textContent=total===0?'0/0':`${Math.ceil(start+1)}-${Math.min(start+slice.length,total)} of ${total}`;
    document.getElementById('prev').disabled=page<=1;document.getElementById('next').disabled=start+PAGE>=total;
  }
  function wire(){
    document.getElementById('q').oninput=apply;
    document.getElementById('year').onchange=apply;
    document.getElementById('reset').onclick=()=>{document.getElementById('q').value='';document.getElementById('year').value='';sysFilter='';sysBtn.textContent='Systems ▾';apply();};
    sysMenu.querySelectorAll('a').forEach(a=>a.onclick=(e)=>{e.preventDefault();sysFilter=a.dataset.sys;sysBtn.textContent=`Systems: ${sysFilter||'All'} ▾`;sysMenu.style.display='none';apply();});
    document.getElementById('prev').onclick=()=>{if(page>1){page--;render();}};document.getElementById('next').onclick=()=>{if((page*PAGE)<filtered.length){page++;render();}};
  }
  load();
  </script>

  <!-- Particles -->
  <script src="assets/particles.min.js"></script>
  <script>
    particlesJS.load('particles-js', 'assets/particles.json', ()=>console.log('particles loaded'));
  </script>

  <!-- Wave titles: only the big hero title on home -->
  <script>
  (function(){
    const reduceMotion = matchMedia('(prefers-reduced-motion: reduce)').matches;
    function waveify(el){
      if(!el || el.classList.contains('wave-text')) return;
      const text = el.textContent.trim();
      el.textContent = '';
      el.classList.add('wave-text');
      const baseDelay = 0.08;
      [...text].forEach((ch,i)=>{
        const span = document.createElement('span');
        span.className = 'wave-char';
        span.textContent = ch;
        if(!reduceMotion) span.style.animationDelay = (i * baseDelay) + 's';
        el.appendChild(span);
      });
    }
    document.addEventListener('DOMContentLoaded', ()=>{
      const heroTitle = document.querySelector('.hero .hero-title');
      if(heroTitle) waveify(heroTitle);
    });
  })();
  </script>
</body>
</html>
